import{pascalCase as e}from"change-case";import{diffLines as t}from"diff";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a=/*#__PURE__*/function(){function t(){this._cache=new Map,this._cache_r=new Map,this._unnameCount=0}var r=t.prototype;return r._printCache=function(){return this._cache_r.size>0?Array.from(this._cache_r.entries()).map(function(e){return"interface "+e[0]+e[1]}).join("\n"):""},r.parseToTypes=function(e,t){if(void 0===t&&(t="DefaultInterface"),"object"!=typeof e)throw TypeError('param "obj" must be an object, but got '+typeof e);return"interface "+t+this._parseObjectToTypes(e)+"\n"+this._printCache()},r._parseObjectToTypes=function(e){var t=this;return"{\n"+Object.entries(e).map(function(e){var r,n=e[1],a=(r=e[0]).match(/^\d/)||r.match(/[\u0000-#%-/:-@[-^`{-\u007f]/)?'"'+r+'"':r;return a+":"+t._typeof(n,a)}).join("\n")+"\n}"},r._printArrayType=function(e){for(var t,r,a=this,o=new Set,c=n(e);!(t=c()).done;)o.add(i(t.value));for(var s,f=n(e);!(s=f()).done;)o.add(i(s.value));if(1==o.size&&o.has("Object")){o.clear();for(var h,p=n(e);!(h=p()).done;)o.add(this._checkThenParseObject(h.value));var l=Array.from(o);if(1==o.size)r=l.join(" | ");else{for(var m=l.map(function(e){return a._cache_r.get(e)}),y=m[0],v=l[0],d=1;d<m.length;d++){var _=u(y,m[d]);if(!_)return"Array<"+(r=l.join(" | "))+">";y=_,v=v.concat(l[d])}for(var b=0;b<m.length;b++)this._cache.set(m[b],{name:v}),this._cache_r.delete(l[b]);this._cache_r.set(v,y),r=v}}else r=0===e.length?"unknown":Array.from(o).join(" | ");return"Array<"+r+">"},r._checkThenParseObject=function(t,r){if(t instanceof Array)return this._printArrayType(t);if(null!=t){if(r){var n=this._tryParseIdMap(t,r);if(n)return n}var a=this._parseObjectToTypes(t);if(a.match(/{\s*}/))return a;var i=this._cache.get(a);if(i)return i.name;for(var o,u=r?e(r.match(/^["']\d/)?"I"+r:r):this._defaultName();o=this._cache_r.get(u);){var s=c(o,a);if(s){this._cache.set(s,{name:u}),this._cache.set(o,{name:u}),this._cache.set(a,{name:u}),this._cache_r.set(u,s);break}u=u.concat("_")}return this._cache_r.set(u,a),this._cache.set(a,{name:u}),u}return"null"},r._tryParseIdMap=function(e,t){var r=this,n=t,a=Array.from(Object.keys(e));if(a.length>0&&a.every(function(e){return e.match(/^\d+$/)}))return"{[id:number]:"+Array.from(new Set(Object.values(e).map(function(e){return r._typeof(e,n)}))).join("|")+"}"},r._typeof=function(e,t){var r=typeof e;switch(r){case"object":return this._checkThenParseObject(e,t);case"undefined":case"boolean":case"number":case"string":return r;default:throw r+" isn't support yet."}},r._defaultName=function(){return"I"+this._unnameCount++},t}();function i(e){var t=typeof e;switch(t){case"object":return"Object";case"undefined":case"boolean":case"number":case"string":return t;default:throw t+" isn't support yet."}}var o=function(e){return e.startsWith("{")&&e.endsWith("}")};function c(e,t){if(o(e)&&o(t)){var r=s(e,t),n=r[0],a=r[1],i=r[2];if(n.length>=a.length+i.length)return f(n,a,i)}}var u=function(e,t){return f.apply(void 0,s(e,t))};function s(e,r){for(var a,i=[],o=[],c=[],u=n(t(e.replaceAll(/^{|}/gm,""),r.replaceAll(/^{|}/gm,"")));!(a=u()).done;){var s=a.value;s.added?o.push.apply(o,h(s.value)):s.removed?c.push.apply(c,h(s.value)):i.push.apply(i,h(s.value))}return[i,o,c]}function f(e,t,r){for(var a,i=Object.fromEntries(r),o=n(t);!(a=o()).done;)if(i[a.value[0]])return;return"{\n"+[].concat([].concat(t,r).map(function(e){return e[0]+"?:"+e[1]}),e.map(function(e){return e[0]+":"+e[1]})).join("\n")+"\n}"}var h=function(e){return e.split("\n").filter(function(e){return""!=e}).map(function(e){return e.split(":")})};function p(e,t){return void 0===t&&(t="DefaultInterface"),(new a).parseToTypes(JSON.parse(e),t)}export{a as Json2Type,p as parseToTypes};
//# sourceMappingURL=index.mjs.map
